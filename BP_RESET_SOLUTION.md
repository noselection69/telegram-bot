# ‚úÖ –†–ï–®–ï–ù–ò–ï: –ö–∞–∫ –æ–±–Ω–æ–≤–∏—Ç—å BP –∑–∞–¥–∞–Ω–∏—è –Ω–∞ Railway

## üéØ –ü—Ä–æ–±–ª–µ–º–∞ (–ù–ê–ô–î–ï–ù–ê)

–ù–∞ Railway –æ—Å—Ç–∞—é—Ç—Å—è **—Å—Ç–∞—Ä—ã–µ 3 –∑–∞–¥–∞–Ω–∏—è –≤–º–µ—Å—Ç–æ 59 –Ω–æ–≤—ã—Ö** –ø–æ—Ç–æ–º—É —á—Ç–æ:

1. **`seed_bp_tasks.py` —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª–æ–∫–∞–ª—å–Ω–æ–π SQLite** (`bot_data.db`), –∞ –Ω–µ —Å Railway PostgreSQL
2. **–ù–∞ Railway –µ—Å—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º**, –Ω–æ –æ–Ω –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
3. **–ï—Å—Ç—å –∞–¥–º–∏–Ω—Å–∫–∏–π —ç–Ω–¥–ø–æ–∏–Ω—Ç** `/api/admin/reset-bp-tasks` –¥–ª—è —Å–±—Ä–æ—Å–∞

---

## üîß –†–ï–®–ï–ù–ò–ï: 3 —Å–ø–æ—Å–æ–±–∞

### –°–ø–æ—Å–æ–± 1Ô∏è‚É£ - –ê–î–ú–ò–ù–°–ö–ò–ô –≠–ù–î–ü–û–ò–ù–¢ (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø - –°–ê–ú–´–ô –ë–´–°–¢–†–´–ô)

–≠—Ç–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç –≤ `bot/web/app.py` (—Å—Ç—Ä–æ–∫–∞ 1358).

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
curl -X POST https://–≤–∞—à-bot.railway.app/api/admin/reset-bp-tasks \
  -H "X-Admin-Key: gta5rp_admin_2024" \
  -H "Content-Type: application/json"
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- ‚úÖ –£–¥–∞–ª—è–µ—Ç –≤—Å–µ —Å—Ç–∞—Ä—ã–µ –∑–∞–¥–∞–Ω–∏—è –∏–∑ `bp_tasks`
- ‚úÖ –î–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –∏–∑ 59 –∑–∞–¥–∞–Ω–∏–π (28 –ª–µ–≥–∫–∏—Ö + 19 —Å—Ä–µ–¥–Ω–∏—Ö + 12 —Ç—è–∂–µ–ª—ã—Ö)
- ‚úÖ –õ–æ–≥–∏—Ä—É–µ—Ç —Å–∫–æ–ª—å–∫–æ —É–¥–∞–ª–µ–Ω–æ –∏ —Å–∫–æ–ª—å–∫–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å **—Ä–µ–∞–ª—å–Ω–æ–π –±–∞–∑–æ–π Railway PostgreSQL**

**–û—Ç–≤–µ—Ç –ø—Ä–∏ —É—Å–ø–µ—Ö–µ:**
```json
{
  "success": true,
  "deleted": 3,
  "added": 59
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- üöÄ –†–∞–±–æ—Ç–∞–µ—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
- üîí –ó–∞—â–∏—â–µ–Ω –∫–ª—é—á–æ–º `gta5rp_admin_2024`
- ‚úÖ –õ–æ–≥–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- üì± –ú–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å –∏–∑ Postman, curl –∏–ª–∏ –ª—é–±–æ–≥–æ HTTP –∫–ª–∏–µ–Ω—Ç–∞

---

### –°–ø–æ—Å–æ–± 2Ô∏è‚É£ - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ

**–ì–¥–µ:** `bot/web/app.py` —Å—Ç—Ä–æ–∫–∏ 155-240

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
```python
if existing < 50:  # –ï—Å–ª–∏ –∑–∞–¥–∞–Ω–∏–π –º–µ–Ω—å—à–µ 50
    # –û—á–∏—â–∞–µ—Ç –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç 59 –Ω–æ–≤—ã—Ö
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –≠—Ç–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SQLite –Ω–∞ Railway, –∞ –Ω–µ PostgreSQL.

**–ö–∞–∫ –≤–∫–ª—é—á–∏—Ç—å:**
1. Hard redeploy –Ω–∞ Railway (–ø–æ–ª–Ω–∞—è –ø–µ—Ä–µ–±–æ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞)
2. –ò–ª–∏ –≤—Ä—É—á–Ω—É—é —É–¥–∞–ª–∏—Ç—å `bot_data.db` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º
3. –¢–æ–≥–¥–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–∑–¥–∞—Å—Ç –Ω–æ–≤—É—é –ë–î —Å 59 –∑–∞–¥–∞–Ω–∏—è–º–∏

---

### –°–ø–æ—Å–æ–± 3Ô∏è‚É£ - –ò—Å–ø—Ä–∞–≤–∏—Ç—å `seed_bp_tasks.py`

**–¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞:** –°–∫—Ä–∏–ø—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª–æ–∫–∞–ª—å–Ω–æ–π SQLite.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**

–í `Procfile` –¥–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ü–∏—é `release`:

```procfile
release: python seed_bp_tasks.py
web: python migrate_postgresql.py && python -m bot.main
```

**–ò –æ–±–Ω–æ–≤–∏—Ç—å `seed_bp_tasks.py`:**

```python
#!/usr/bin/env python3
import os
import sys
from dotenv import load_dotenv

load_dotenv()

DATABASE_URL = os.environ.get('DATABASE_URL')

if not DATABASE_URL:
    print("‚ùå DATABASE_URL –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞")
    sys.exit(1)

print("üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é BP –∑–∞–¥–∞–Ω–∏—è –Ω–∞ Railway...")

# –ó–¥–µ—Å—å –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ PostgreSQL –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç 59 –∑–∞–¥–∞–Ω–∏–π
# (–∫–æ–¥ –∏–∑ admin_reset_bp_tasks)
```

---

## üìã –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–¥–∞

### ‚úÖ –ß—Ç–æ –£–ñ–ï —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

1. **–í `bot/web/app.py`:**
   - ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ (—Å—Ç—Ä–æ–∫–∏ 155-240)
   - ‚úÖ –ê–¥–º–∏–Ω—Å–∫–∏–π —ç–Ω–¥–ø–æ–∏–Ω—Ç `/api/admin/reset-bp-tasks` (—Å—Ç—Ä–æ–∫–∏ 1358+)
   - ‚úÖ –û–±–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∏–∑ 59 –∑–∞–¥–∞–Ω–∏–π (28+19+12)

2. **–í `bot/models/database.py`:**
   - ‚úÖ –ú–æ–¥–µ–ª—å `BPTask` —Å –ø–æ–ª—è–º–∏ name, category, bp_without_vip, bp_with_vip
   - ‚úÖ –ú–æ–¥–µ–ª—å `BPCompletion` –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

3. **–í `bot/web/static/app.js`:**
   - ‚úÖ –§—É–Ω–∫—Ü–∏—è `loadBPTasks()` - –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏–∑ `/api/get-bp-tasks`
   - ‚úÖ –§—É–Ω–∫—Ü–∏—è `loadBPStats()` - –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

4. **–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã:**
   - ‚úÖ `/api/get-bp-tasks` (GET) - –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∑–∞–¥–∞–Ω–∏—è
   - ‚úÖ `/api/get-bp-stats` (GET) - –ø–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
   - ‚úÖ `/api/admin/reset-bp-tasks` (POST) - —Å–±—Ä–æ—Å (–∞–¥–º–∏–Ω-–∫–ª—é—á: `gta5rp_admin_2024`)

### ‚ùå –ß—Ç–æ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç:

- ‚ùå –ù–∞ Railway –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Å—Ç–∞—Ä—ã–µ 3 –∑–∞–¥–∞–Ω–∏—è –≤–º–µ—Å—Ç–æ 59
- ‚ùå `seed_bp_tasks.py` —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª–æ–∫–∞–ª—å–Ω–æ–π SQLite, –Ω–µ —Å PostgreSQL
- ‚ùå –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∞ –Ω–∞ Railway

---

## üöÄ –ù–ï–ú–ï–î–õ–ï–ù–ù–û–ï –î–ï–ô–°–¢–í–ò–ï

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–¥–º–∏–Ω—Å–∫–∏–π —ç–Ω–¥–ø–æ–∏–Ω—Ç –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å:**

```bash
# –í Postman –∏–ª–∏ terminal:
POST https://–≤–∞—à-–±–æ—Ç.railway.app/api/admin/reset-bp-tasks
Header: X-Admin-Key = gta5rp_admin_2024
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- üóëÔ∏è –£–¥–∞–ª–∏—Ç 3 —Å—Ç–∞—Ä—ã—Ö –∑–∞–¥–∞–Ω–∏—è
- ‚ûï –î–æ–±–∞–≤–∏—Ç 59 –Ω–æ–≤—ã—Ö (–ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä GTA5 RP)
- ‚úÖ –ù–∞ –±–æ—Ç–µ —Å—Ä–∞–∑—É –ø–æ—è–≤—è—Ç—Å—è –Ω–æ–≤—ã–µ –∑–∞–¥–∞–Ω–∏—è

---

## üìù –°–ø–∏—Å–æ–∫ 59 –∑–∞–¥–∞–Ω–∏–π (—á—Ç–æ –¥–æ–±–∞–≤–∏—Ç—Å—è)

**–õ–Å–ì–ö–ò–ï (28):**
- 3 —á–∞—Å–∞ –≤ –æ–Ω–ª–∞–π–Ω–µ
- –ù—É–ª–∏ –≤ –∫–∞–∑–∏–Ω–æ
- –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –≤ —Ç–∏—Ä–µ
- –ê—Ä–µ–Ω–¥–æ–≤–∞—Ç—å –∫–∏–Ω–æ—Å—Ç—É–¥–∏—é
- –ö—É–ø–∏—Ç—å –ª–æ—Ç–µ—Ä–µ–π–Ω—ã–π –±–∏–ª–µ—Ç
- ... (–µ—â—ë 23)

**–°–†–ï–î–ù–ò–ï (19):**
- 25 –¥–µ–π—Å—Ç–≤–∏–π –Ω–∞ —Å—Ç—Ä–æ–π–∫–µ
- 25 –¥–µ–π—Å—Ç–≤–∏–π –≤ –ø–æ—Ä—Ç—É
- 25 –¥–µ–π—Å—Ç–≤–∏–π –≤ —à–∞—Ö—Ç–µ
- ... (–µ—â—ë 16)

**–¢–Ø–ñ–Å–õ–´–ï (12):**
- –ó–∞–∫–∞–∑ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –¥–ª—è –±–∏–∑–Ω–µ—Å–∞
- –î–≤–∞ —Ä–∞–∑–∞ –æ–ø–ª–∞—Ç–∏—Ç—å —Å–º–µ–Ω—É –≤–Ω–µ—à–Ω–æ—Å—Ç–∏
- 7 –∑–∞–∫—Ä–∞—à–µ–Ω–Ω—ã—Ö –≥—Ä–∞—Ñ—Ñ–∏—Ç–∏
- ... (–µ—â—ë 9)

---

## üîë Admin Key

```
X-Admin-Key: gta5rp_admin_2024
```

–ù–∞–π—Ç–∏ –º–æ–∂–Ω–æ –≤ `bot/web/app.py` —Å—Ç—Ä–æ–∫–∞ 1363

---

## ‚úÖ –ò—Ç–æ–≥–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ

**–í–ê–ñ–ù–û–ï:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **—Å–ø–æ—Å–æ–± 1** - –∞–¥–º–∏–Ω—Å–∫–∏–π —ç–Ω–¥–ø–æ–∏–Ω—Ç. –≠—Ç–æ:
- ‚úÖ –°–∞–º–æ–µ –±—ã—Å—Ç—Ä–æ–µ
- ‚úÖ –°–∞–º–æ–µ –Ω–∞–¥–µ–∂–Ω–æ–µ
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å —Ä–µ–∞–ª—å–Ω–æ–π –ë–î
- ‚úÖ –õ–æ–≥–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏

–ü—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ POST –∑–∞–ø—Ä–æ—Å –Ω–∞ `/api/admin/reset-bp-tasks` —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –∫–ª—é—á–æ–º - –∏ –≤—Å—ë –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–æ! üéØ
