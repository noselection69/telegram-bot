# Миграция: Исправление ошибки telegram_id

## Проблема

При добавлении товара у некоторых пользователей возникает ошибка:
```
psycopg2.errors.NumericValueOutOfRange: integer out of range
```

Это происходит потому, что в базе данных колонка `telegram_id` имеет тип `Integer` (32-бит), а некоторые Telegram ID требуют `BigInteger` (64-бит).

## Решение

Есть два способа исправить эту проблему:

### Способ 1: Автоматическое исправление (рекомендуется)

Теперь при старте приложения на PostgreSQL автоматически проверяется и исправляется тип колонки `telegram_id`. 

**Что делать**: Просто перезагрузите приложение на Railway:
1. Перейдите в Dashboard Railway
2. Нажмите "Deploy" или перезагрузите контейнер
3. Приложение автоматически выполнит миграцию при инициализации БД

### Способ 2: Ручная миграция

Если автоматическое исправление не сработало:

```bash
# Локально или на сервере с доступом к DATABASE_URL
python migrate_telegram_id.py
```

**Требования**: Переменная окружения `DATABASE_URL` должна быть установлена.

## Что было изменено

1. **database.py** - уже использует `BigInteger` для `telegram_id` ✅
2. **init_db.py** - добавлена проверка и автоматическая миграция при инициализации БД ✅
3. **migrate_telegram_id.py** - отдельный скрипт для ручной миграции (если требуется)

## Ожидаемые результаты

После миграции:
- Пользователи с большими Telegram ID смогут добавлять товары без ошибок
- Новые пользователи будут создаваться с правильным типом `BigInteger`
- Существующие данные сохранятся корректно

## Проверка результата

После миграции можно проверить тип колонки в PostgreSQL:
```sql
SELECT data_type FROM information_schema.columns 
WHERE table_name = 'users' AND column_name = 'telegram_id';
```

Ожидаемый результат: `bigint`
