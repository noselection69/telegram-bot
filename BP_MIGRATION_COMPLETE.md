# üö® –û–ö–û–ù–ß–ê–¢–ï–õ–¨–ù–û–ï –†–ï–®–ï–ù–ò–ï: –ë–ü –ó–∞–¥–∞–Ω–∏—è –Ω–∞ Railway

## üìã –ü–†–û–ë–õ–ï–ú–ê –ù–ê–ô–î–ï–ù–ê –ò –†–ï–®–ï–ù–ê

### –ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ:
1. **–°—Ç–∞—Ä—ã–µ –∑–∞–¥–∞–Ω–∏—è** (9 —à—Ç) –æ—Å—Ç–∞–ª–∏—Å—å –≤ PostgreSQL Railway
2. **–ù–æ–≤—ã–µ –∑–∞–¥–∞–Ω–∏—è** (59 —à—Ç) –±—ã–ª–∏ –Ω–∞–ø–∏—Å–∞–Ω—ã –≤ `app.py` –Ω–æ **–Ω–µ –ø—Ä–∏–º–µ–Ω–∏–ª–∏—Å—å**
3. –õ–æ–≥–∏–∫–∞ –∞–≤—Ç–æ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ `app.py` **–Ω–µ –≤—ã–ø–æ–ª–Ω–∏–ª–∞—Å—å** –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ

### –ü–æ—á–µ–º—É:
- `init_bp_tasks.py` —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç–∞—Ä—ã–µ 9 –∑–∞–¥–∞–Ω–∏–π
- `app.py` –∏–º–µ–µ—Ç –ª–æ–≥–∏–∫—É –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ 59 –Ω–æ–≤—ã—Ö –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ (–µ—Å–ª–∏ < 50)
- **–ù–æ —ç—Ç–∞ –ª–æ–≥–∏–∫–∞ –Ω–∞ Railway –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∞**

---

## ‚úÖ –†–ï–®–ï–ù–ò–ï

### **–®–ê–ì–ò:**

#### 1Ô∏è‚É£ **–û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–¥ (—É–∂–µ —Å–¥–µ–ª–∞–Ω–æ):**
```bash
git pull origin main
```

–≠—Ç–æ –∑–∞–≥—Ä—É–∑–∏—Ç:
- ‚úÖ –ù–æ–≤—ã–π `force_update_railway_db.py` (raw SQL –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π `init_bp_tasks.py` (59 –Ω–æ–≤—ã—Ö –∑–∞–¥–∞–Ω–∏–π)
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π `app.py` (–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è)

#### 2Ô∏è‚É£ **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î:**

**–°–ø–æ—Å–æ–± A: Railway CLI** (–î–û 5 –º–∏–Ω—É—Ç)
```bash
railway run python force_update_railway_db.py
```

**–°–ø–æ—Å–æ–± B: Railway Dashboard**
1. –û—Ç–∫—Ä–æ–π—Ç–µ Railway Dashboard
2. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
3. –ù–∞–∂–º–∏—Ç–µ **Console** (–≤ Deployment)
4. –í—ã–ø–æ–ª–Ω–∏—Ç–µ:
   ```bash
   cd /app
   python force_update_railway_db.py
   ```

#### 3Ô∏è‚É£ **–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
```bash
railway restart
# –∏–ª–∏ —á–µ—Ä–µ–∑ Dashboard: Redeploy
```

#### 4Ô∏è‚É£ **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –û—Ç–∫—Ä–æ–π—Ç–µ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ **"‚≠ê –§–∞—Ä–º BP"**
- –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
  - ‚úÖ –õ–µ–≥–∫–∏–µ (28)
  - ‚úÖ –°—Ä–µ–¥–Ω–∏–µ (19)
  - ‚úÖ –¢—è–∂–µ–ª—ã–µ (12)
  - ‚úÖ **–ò–¢–û–ì–û: 59 –∑–∞–¥–∞–Ω–∏–π**

---

## üîç –ß–¢–û –ë–´–õ–û –ò–°–ü–†–ê–í–õ–ï–ù–û

### –§–∞–π–ª 1: `force_update_railway_db.py` (–ù–û–í–´–ô)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç **RAW SQL** –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
- –ü—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL
- –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç asyncpg URL –≤ psycopg2
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î

### –§–∞–π–ª 2: `init_bp_tasks.py` (–û–ë–ù–û–í–õ–ï–ù)
- –°–æ–¥–µ—Ä–∂–∏—Ç **59 –Ω–æ–≤—ã—Ö GTA5 RP –∑–∞–¥–∞–Ω–∏–π** –≤–º–µ—Å—Ç–æ 9
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ (–µ—Å–ª–∏ < 50, –æ–±–Ω–æ–≤–ª—è–µ—Ç)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞

### –§–∞–π–ª 3: `app.py` (–£–ñ–ï –ë–´–õ)
- –£–∂–µ —Å–æ–¥–µ—Ä–∂–∞–ª –ª–æ–≥–∏–∫—É –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ 59 –∑–∞–¥–∞–Ω–∏–π
- –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

## ‚ö†Ô∏è –í–ê–ñ–ù–û: –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

```mermaid
Railway Start
    ‚Üì
app.py –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
    ‚Üì
Base.metadata.create_all() - —Å–æ–∑–¥–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—ã
    ‚Üì
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç COUNT(*) FROM bp_tasks
    ‚Üì
IF count < 50 THEN
    DELETE FROM bp_tasks
    INSERT 59 –Ω–æ–≤—ã—Ö –∑–∞–¥–∞–Ω–∏–π
    ‚úÖ –ì–û–¢–û–í–û
ELSE
    count >= 50 ‚Üí –∑–∞–¥–∞–Ω–∏—è –∞–∫—Ç—É–∞–ª—å–Ω—ã
END
```

---

## üõ†Ô∏è –ï–°–õ–ò –í–°–ï –†–ê–í–ù–û –ù–ï –†–ê–ë–û–¢–ê–ï–¢

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
1. –ó–∞–ø—É—Å—Ç–∏–ª—Å—è –ª–∏ —Å–∫—Ä–∏–ø—Ç –±–µ–∑ –æ—à–∏–±–æ–∫?
   - –î–æ–ª–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏: `‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ: 59 –Ω–æ–≤—ã—Ö –∑–∞–¥–∞–Ω–∏–π —á–µ—Ä–µ–∑ RAW SQL`

2. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏–ª–∏ –ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ?
   - –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ: `railway restart`

3. –û—á–∏—Å—Ç–∏–ª–∏ –ª–∏ –±—Ä–∞—É–∑–µ—Ä?
   - F12 ‚Üí Application ‚Üí Clear site data
   - –ò–ª–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ —Ä–µ–∂–∏–º–µ

4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
   ```bash
   railway logs
   ```
   - –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `‚úÖ BP tasks updated (59 tasks...)`

---

## üìù –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô

1. ‚úÖ –ö–æ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω (pull latest)
2. ‚è≥ –ó–∞–ø—É—Å—Ç–∏—Ç—å `force_update_railway_db.py`
3. ‚è≥ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (`railway restart`)
4. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

**–ì–æ—Ç–æ–≤–æ!**

---

## üìä –§–ò–ù–ê–õ–¨–ù–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ –±—É–¥–µ—Ç:

‚úÖ **28 –õ–µ–≥–∫–∏—Ö** –ë–ü –∑–∞–¥–∞–Ω–∏–π  
‚úÖ **19 –°—Ä–µ–¥–Ω–∏—Ö** –ë–ü –∑–∞–¥–∞–Ω–∏–π  
‚úÖ **12 –¢—è–∂–µ–ª—ã—Ö** –ë–ü –∑–∞–¥–∞–Ω–∏–π  
‚úÖ **–í–°–ï–ì–û: 59 –∑–∞–¥–∞–Ω–∏–π**  
‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è **–≤—ã—à–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏**  
‚úÖ **–ü–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã**
